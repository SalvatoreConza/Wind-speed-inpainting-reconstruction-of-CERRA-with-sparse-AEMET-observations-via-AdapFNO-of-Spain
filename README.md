# Adaptive Fourier Neural Operator (AFNO) 2D Model

This repository contains the implemenattion for 
the Adaptive Fourier Neural Operator (`AFNO2d`) model
to solve the 2-Dimensional React-Diffusion Equation 
(`ReactDiff2D`). 

The data is generated by `PDEBench` 
(https://github.com/pdebench/PDEBench)

## Getting Started

### Prerequisites

- Python 3.10
- CUDA 12.x
- vRAM >= 48 GB
- Required Python packages (listed in `environment.yaml`)

### Set-up

1. Clone the repository:
   ```bash
   git clone https://github.com/hiepdang-ml/neural_operator.git
   cd neural_operator

2. Set environment variables:
    ```bash
    export PYTHONPATH=.

3. Create Conda environment and instlal dependencies
    ```bash
    conda env create -f environment.yaml
    conda activate neural_operator

### Prepare Dataset
Put the `.h5` data file in anywhere in the current working directory

### Training:
1. Config the model architecture and the training process at `configs/train_afno2d.yaml`
2. Run the command:
    ```bash
    python train.py --config configs/train_afno2d.yaml
3. The model checkpoints are regularly saved in `.checkpoints` directory
    and the training log is saved in `.logs` directory

### Predicting:
1. Config the model architecture and the training process at `configs/predict_afno2d.yaml`. 
    We typically set `from_sample` and `to_sample` such that the model makes predictions on 
    unseen data
2. Run the command:
    ```bash
    python predict.py --config configs/predict_afno2d.yaml
3. The prediction results are saved under `results` directory

